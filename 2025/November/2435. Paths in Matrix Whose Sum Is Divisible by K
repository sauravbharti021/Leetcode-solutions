#define mod 1000000007
#define ll long long
class Solution {
public:
    vector<vector<vector<int>>> dp;
    int recur(int i, int j, vector<vector<int>> &g, int k,int sum){
        int n = g.size(), m = g[0].size();
        if(i==n-1 && j==m-1){
            if(((sum)+g[i][j])%k==0) return 1;
            return 0;
        }
        if(i<0 || j<0 || i>=n || j>=m) return 0;
        if(dp[i][j][sum]!=-1) return dp[i][j][sum];

        int ans= 0;
        if(i+1< n){
            ans = (ans + recur(i+1, j, g, k, (sum+g[i][j])%k))%mod;
        }
        if(j+1<m){
            ans = (ans + recur(i,j+1, g, k, (sum+g[i][j])%k))%mod;
        }

        return dp[i][j][sum] = ans;
    }
    int numberOfPaths(vector<vector<int>>& grid, int k) {
        int n = grid.size(), m= grid[0].size();
        dp.assign(n+1, vector<vector<int>> (m+1, vector<int>(k+1, -1)));

        ll ans = recur(0, 0, grid, k, 0);
        return ans; 
    }
};
