class Solution {
public:
    int maxFrequency(vector<int>& nums, int k, int numOperations) {
        int n = nums.size();
        vector<int> frePlusPre(1e5+1, 0);
        for(int i=0;i<n;i++){
            frePlusPre[nums[i]]+=1;
        }
        for(int i=1;i<=1e5;i++){
            frePlusPre[i]+= frePlusPre[i-1];
        }
        int mx = 0;
        for(int i=0;i<=1e5;i++){
            int left = max(0, i-k);
            int right = min(100000, i+k);

            int allExtra = frePlusPre[right] - (left>0 ? frePlusPre[left-1] : 0) - (frePlusPre[i] - (i>0 ? frePlusPre[i-1] : 0) );
            mx = max(mx, min(allExtra, numOperations) + (frePlusPre[i] - (i>0 ? frePlusPre[i-1]: 0)));
        }

        return mx;

    }
};
